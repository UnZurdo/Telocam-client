{"remainingRequest":"/Users/zurdo/Projects/vue-auth-vuex/node_modules/thread-loader/dist/cjs.js!/Users/zurdo/Projects/vue-auth-vuex/node_modules/babel-loader/lib/index.js!/Users/zurdo/Projects/vue-auth-vuex/node_modules/eslint-loader/index.js??ref--13-0!/Users/zurdo/Projects/vue-auth-vuex/src/store.js","dependencies":[{"path":"/Users/zurdo/Projects/vue-auth-vuex/src/store.js","mtime":1548388951919},{"path":"/Users/zurdo/Projects/vue-auth-vuex/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zurdo/Projects/vue-auth-vuex/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zurdo/Projects/vue-auth-vuex/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zurdo/Projects/vue-auth-vuex/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Promise from \"/Users/zurdo/Projects/vue-auth-vuex/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\nimport Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport axios from \"axios\";\nimport { API_BASE } from \"./config\";\nVue.use(Vuex);\nexport default new Vuex.Store({\n  state: {\n    status: \"\",\n    token: localStorage.getItem(\"token\") || \"\",\n    esAdmin: localStorage.getItem(\"esAdmin\") || false,\n    user: {}\n  },\n  mutations: {\n    auth_request: function auth_request(state) {\n      state.status = \"loading\";\n    },\n    auth_success: function auth_success(state, token, user, esAdmin) {\n      state.status = \"success\";\n      state.token = token;\n      state.user = user;\n      state.esAdmin = localStorage.getItem(\"esAdmin\");\n      console.log(\"Auth sucessful\", state);\n    },\n    auth_error: function auth_error(state) {\n      state.status = \"error\";\n    },\n    logout: function logout(state) {\n      state.status = \"\";\n      state.token = \"\";\n    }\n  },\n  actions: {\n    login: function login(_ref, user) {\n      var commit = _ref.commit;\n      return new _Promise(function (resolve, reject) {\n        commit(\"auth_request\");\n        axios({\n          url: \"\".concat(API_BASE, \"/user/login\"),\n          data: user,\n          method: \"POST\"\n        }).then(function (resp) {\n          console.log(resp);\n          var token = resp.data.account.token;\n          var user = resp.data.account.email;\n          var esAdmin = resp.data.account.esAdmin;\n          var empresaFK = resp.data.account.EmpresaFK;\n          console.log(token, user, esAdmin);\n          localStorage.setItem(\"token\", token);\n          localStorage.setItem(\"user\", user);\n          localStorage.setItem(\"esAdmin\", esAdmin);\n          localStorage.setItem(\"empresaFK\", empresaFK); // Add the following line:\n\n          axios.defaults.headers.common[\"Authorization\"] = token;\n          commit(\"auth_success\", token, user, esAdmin);\n          resolve(resp);\n        }).catch(function (err) {\n          commit(\"auth_error\");\n          localStorage.removeItem(\"token\");\n          localStorage.removeItem(\"user\");\n          localStorage.removeItem(\"esAdmin\");\n          localStorage.removeItem(\"empresaFK\");\n          reject(err);\n        });\n      });\n    },\n    register: function register(_ref2, user) {\n      var commit = _ref2.commit;\n      return new _Promise(function (resolve, reject) {\n        commit(\"auth_request\");\n        axios({\n          url: \"\".concat(API_BASE, \"/user/new\"),\n          data: user,\n          method: \"POST\"\n        }).then(function (resp) {\n          console.log(resp);\n          var token = resp.data.token;\n          var user = resp.data.user;\n          var esEmpresa = resp.data.esEmpresa;\n          localStorage.setItem(\"token\", token);\n          localStorage.setItem(\"user\", user);\n          localStorage.setItem(\"esEmpresa\", esEmpresa); // Add the following line:\n\n          axios.defaults.headers.common[\"Authorization\"] = token;\n          commit(\"auth_success\", token, user);\n          resolve(resp);\n        }).catch(function (err) {\n          commit(\"auth_error\", err);\n          localStorage.removeItem(\"token\");\n          localStorage.removeItem(\"user\");\n          reject(err);\n        });\n      });\n    },\n    logout: function logout(_ref3) {\n      var commit = _ref3.commit;\n      return new _Promise(function (resolve, reject) {\n        commit(\"logout\");\n        localStorage.removeItem(\"token\");\n        delete axios.defaults.headers.common[\"Authorization\"];\n        resolve();\n      });\n    }\n  },\n  getters: {\n    isLoggedIn: function isLoggedIn(state) {\n      return !!state.token;\n    },\n    isAdmin: function isAdmin(state) {\n      return state.esAdmin;\n    },\n    authStatus: function authStatus(state) {\n      return state.status;\n    },\n    token: function token(state) {\n      return state.token;\n    }\n  }\n});",{"version":3,"sources":["/Users/zurdo/Projects/vue-auth-vuex/src/store.js"],"names":["Vue","Vuex","axios","API_BASE","use","Store","state","status","token","localStorage","getItem","esAdmin","user","mutations","auth_request","auth_success","console","log","auth_error","logout","actions","login","commit","resolve","reject","url","data","method","then","resp","account","email","empresaFK","EmpresaFK","setItem","defaults","headers","common","catch","err","removeItem","register","esEmpresa","getters","isLoggedIn","isAdmin","authStatus"],"mappings":";;;;AAAA,OAAOA,GAAP,MAAgB,KAAhB;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,QAAT,QAAyB,UAAzB;AAEAH,GAAG,CAACI,GAAJ,CAAQH,IAAR;AAEA,eAAe,IAAIA,IAAI,CAACI,KAAT,CAAe;AAC5BC,EAAAA,KAAK,EAAE;AACLC,IAAAA,MAAM,EAAE,EADH;AAELC,IAAAA,KAAK,EAAEC,YAAY,CAACC,OAAb,CAAqB,OAArB,KAAiC,EAFnC;AAGLC,IAAAA,OAAO,EAAEF,YAAY,CAACC,OAAb,CAAqB,SAArB,KAAmC,KAHvC;AAILE,IAAAA,IAAI,EAAE;AAJD,GADqB;AAO5BC,EAAAA,SAAS,EAAE;AACTC,IAAAA,YADS,wBACIR,KADJ,EACW;AAClBA,MAAAA,KAAK,CAACC,MAAN,GAAe,SAAf;AACD,KAHQ;AAITQ,IAAAA,YAJS,wBAIIT,KAJJ,EAIWE,KAJX,EAIkBI,IAJlB,EAIwBD,OAJxB,EAIiC;AACxCL,MAAAA,KAAK,CAACC,MAAN,GAAe,SAAf;AACAD,MAAAA,KAAK,CAACE,KAAN,GAAcA,KAAd;AACAF,MAAAA,KAAK,CAACM,IAAN,GAAaA,IAAb;AACAN,MAAAA,KAAK,CAACK,OAAN,GAAgBF,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAhB;AACAM,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BX,KAA9B;AACD,KAVQ;AAWTY,IAAAA,UAXS,sBAWEZ,KAXF,EAWS;AAChBA,MAAAA,KAAK,CAACC,MAAN,GAAe,OAAf;AACD,KAbQ;AAcTY,IAAAA,MAdS,kBAcFb,KAdE,EAcK;AACZA,MAAAA,KAAK,CAACC,MAAN,GAAe,EAAf;AACAD,MAAAA,KAAK,CAACE,KAAN,GAAc,EAAd;AACD;AAjBQ,GAPiB;AA0B5BY,EAAAA,OAAO,EAAE;AACPC,IAAAA,KADO,uBACWT,IADX,EACiB;AAAA,UAAhBU,MAAgB,QAAhBA,MAAgB;AACtB,aAAO,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCF,QAAAA,MAAM,CAAC,cAAD,CAAN;AACApB,QAAAA,KAAK,CAAC;AACJuB,UAAAA,GAAG,YAAKtB,QAAL,gBADC;AAEJuB,UAAAA,IAAI,EAAEd,IAFF;AAGJe,UAAAA,MAAM,EAAE;AAHJ,SAAD,CAAL,CAKGC,IALH,CAKQ,UAAAC,IAAI,EAAI;AACZb,UAAAA,OAAO,CAACC,GAAR,CAAYY,IAAZ;AAEA,cAAMrB,KAAK,GAAGqB,IAAI,CAACH,IAAL,CAAUI,OAAV,CAAkBtB,KAAhC;AACA,cAAMI,IAAI,GAAGiB,IAAI,CAACH,IAAL,CAAUI,OAAV,CAAkBC,KAA/B;AACA,cAAMpB,OAAO,GAAGkB,IAAI,CAACH,IAAL,CAAUI,OAAV,CAAkBnB,OAAlC;AACA,cAAMqB,SAAS,GAAGH,IAAI,CAACH,IAAL,CAAUI,OAAV,CAAkBG,SAApC;AAEAjB,UAAAA,OAAO,CAACC,GAAR,CAAYT,KAAZ,EAAmBI,IAAnB,EAAyBD,OAAzB;AACAF,UAAAA,YAAY,CAACyB,OAAb,CAAqB,OAArB,EAA8B1B,KAA9B;AACAC,UAAAA,YAAY,CAACyB,OAAb,CAAqB,MAArB,EAA6BtB,IAA7B;AACAH,UAAAA,YAAY,CAACyB,OAAb,CAAqB,SAArB,EAAgCvB,OAAhC;AACAF,UAAAA,YAAY,CAACyB,OAAb,CAAqB,WAArB,EAAkCF,SAAlC,EAZY,CAcZ;;AACA9B,UAAAA,KAAK,CAACiC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiD7B,KAAjD;AACAc,UAAAA,MAAM,CAAC,cAAD,EAAiBd,KAAjB,EAAwBI,IAAxB,EAA8BD,OAA9B,CAAN;AAEAY,UAAAA,OAAO,CAACM,IAAD,CAAP;AACD,SAxBH,EAyBGS,KAzBH,CAyBS,UAAAC,GAAG,EAAI;AACZjB,UAAAA,MAAM,CAAC,YAAD,CAAN;AACAb,UAAAA,YAAY,CAAC+B,UAAb,CAAwB,OAAxB;AACA/B,UAAAA,YAAY,CAAC+B,UAAb,CAAwB,MAAxB;AACA/B,UAAAA,YAAY,CAAC+B,UAAb,CAAwB,SAAxB;AACA/B,UAAAA,YAAY,CAAC+B,UAAb,CAAwB,WAAxB;AAEAhB,UAAAA,MAAM,CAACe,GAAD,CAAN;AACD,SAjCH;AAkCD,OApCM,CAAP;AAqCD,KAvCM;AAwCPE,IAAAA,QAxCO,2BAwCc7B,IAxCd,EAwCoB;AAAA,UAAhBU,MAAgB,SAAhBA,MAAgB;AACzB,aAAO,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCF,QAAAA,MAAM,CAAC,cAAD,CAAN;AACApB,QAAAA,KAAK,CAAC;AACJuB,UAAAA,GAAG,YAAKtB,QAAL,cADC;AAEJuB,UAAAA,IAAI,EAAEd,IAFF;AAGJe,UAAAA,MAAM,EAAE;AAHJ,SAAD,CAAL,CAKGC,IALH,CAKQ,UAAAC,IAAI,EAAI;AACZb,UAAAA,OAAO,CAACC,GAAR,CAAYY,IAAZ;AACA,cAAMrB,KAAK,GAAGqB,IAAI,CAACH,IAAL,CAAUlB,KAAxB;AACA,cAAMI,IAAI,GAAGiB,IAAI,CAACH,IAAL,CAAUd,IAAvB;AACA,cAAM8B,SAAS,GAAGb,IAAI,CAACH,IAAL,CAAUgB,SAA5B;AAEAjC,UAAAA,YAAY,CAACyB,OAAb,CAAqB,OAArB,EAA8B1B,KAA9B;AACAC,UAAAA,YAAY,CAACyB,OAAb,CAAqB,MAArB,EAA6BtB,IAA7B;AACAH,UAAAA,YAAY,CAACyB,OAAb,CAAqB,WAArB,EAAkCQ,SAAlC,EARY,CAUZ;;AACAxC,UAAAA,KAAK,CAACiC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAiD7B,KAAjD;AACAc,UAAAA,MAAM,CAAC,cAAD,EAAiBd,KAAjB,EAAwBI,IAAxB,CAAN;AACAW,UAAAA,OAAO,CAACM,IAAD,CAAP;AACD,SAnBH,EAoBGS,KApBH,CAoBS,UAAAC,GAAG,EAAI;AACZjB,UAAAA,MAAM,CAAC,YAAD,EAAeiB,GAAf,CAAN;AACA9B,UAAAA,YAAY,CAAC+B,UAAb,CAAwB,OAAxB;AACA/B,UAAAA,YAAY,CAAC+B,UAAb,CAAwB,MAAxB;AAEAhB,UAAAA,MAAM,CAACe,GAAD,CAAN;AACD,SA1BH;AA2BD,OA7BM,CAAP;AA8BD,KAvEM;AAwEPpB,IAAAA,MAxEO,yBAwEY;AAAA,UAAVG,MAAU,SAAVA,MAAU;AACjB,aAAO,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCF,QAAAA,MAAM,CAAC,QAAD,CAAN;AACAb,QAAAA,YAAY,CAAC+B,UAAb,CAAwB,OAAxB;AACA,eAAOtC,KAAK,CAACiC,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,CAAP;AACAd,QAAAA,OAAO;AACR,OALM,CAAP;AAMD;AA/EM,GA1BmB;AA2G5BoB,EAAAA,OAAO,EAAE;AACPC,IAAAA,UAAU,EAAE,oBAAAtC,KAAK;AAAA,aAAI,CAAC,CAACA,KAAK,CAACE,KAAZ;AAAA,KADV;AAEPqC,IAAAA,OAAO,EAAE,iBAAAvC,KAAK;AAAA,aAAIA,KAAK,CAACK,OAAV;AAAA,KAFP;AAGPmC,IAAAA,UAAU,EAAE,oBAAAxC,KAAK;AAAA,aAAIA,KAAK,CAACC,MAAV;AAAA,KAHV;AAIPC,IAAAA,KAAK,EAAE,eAAAF,KAAK;AAAA,aAAIA,KAAK,CAACE,KAAV;AAAA;AAJL;AA3GmB,CAAf,CAAf","sourcesContent":["import Vue from \"vue\";\nimport Vuex from \"vuex\";\nimport axios from \"axios\";\nimport { API_BASE } from \"./config\";\n\nVue.use(Vuex);\n\nexport default new Vuex.Store({\n  state: {\n    status: \"\",\n    token: localStorage.getItem(\"token\") || \"\",\n    esAdmin: localStorage.getItem(\"esAdmin\") || false,\n    user: {}\n  },\n  mutations: {\n    auth_request(state) {\n      state.status = \"loading\";\n    },\n    auth_success(state, token, user, esAdmin) {\n      state.status = \"success\";\n      state.token = token;\n      state.user = user;\n      state.esAdmin = localStorage.getItem(\"esAdmin\");\n      console.log(\"Auth sucessful\", state);\n    },\n    auth_error(state) {\n      state.status = \"error\";\n    },\n    logout(state) {\n      state.status = \"\";\n      state.token = \"\";\n    }\n  },\n  actions: {\n    login({ commit }, user) {\n      return new Promise((resolve, reject) => {\n        commit(\"auth_request\");\n        axios({\n          url: `${API_BASE}/user/login`,\n          data: user,\n          method: \"POST\"\n        })\n          .then(resp => {\n            console.log(resp);\n\n            const token = resp.data.account.token;\n            const user = resp.data.account.email;\n            const esAdmin = resp.data.account.esAdmin;\n            const empresaFK = resp.data.account.EmpresaFK;\n\n            console.log(token, user, esAdmin);\n            localStorage.setItem(\"token\", token);\n            localStorage.setItem(\"user\", user);\n            localStorage.setItem(\"esAdmin\", esAdmin);\n            localStorage.setItem(\"empresaFK\", empresaFK);\n\n            // Add the following line:\n            axios.defaults.headers.common[\"Authorization\"] = token;\n            commit(\"auth_success\", token, user, esAdmin);\n\n            resolve(resp);\n          })\n          .catch(err => {\n            commit(\"auth_error\");\n            localStorage.removeItem(\"token\");\n            localStorage.removeItem(\"user\");\n            localStorage.removeItem(\"esAdmin\");\n            localStorage.removeItem(\"empresaFK\");\n\n            reject(err);\n          });\n      });\n    },\n    register({ commit }, user) {\n      return new Promise((resolve, reject) => {\n        commit(\"auth_request\");\n        axios({\n          url: `${API_BASE}/user/new`,\n          data: user,\n          method: \"POST\"\n        })\n          .then(resp => {\n            console.log(resp);\n            const token = resp.data.token;\n            const user = resp.data.user;\n            const esEmpresa = resp.data.esEmpresa;\n\n            localStorage.setItem(\"token\", token);\n            localStorage.setItem(\"user\", user);\n            localStorage.setItem(\"esEmpresa\", esEmpresa);\n\n            // Add the following line:\n            axios.defaults.headers.common[\"Authorization\"] = token;\n            commit(\"auth_success\", token, user);\n            resolve(resp);\n          })\n          .catch(err => {\n            commit(\"auth_error\", err);\n            localStorage.removeItem(\"token\");\n            localStorage.removeItem(\"user\");\n\n            reject(err);\n          });\n      });\n    },\n    logout({ commit }) {\n      return new Promise((resolve, reject) => {\n        commit(\"logout\");\n        localStorage.removeItem(\"token\");\n        delete axios.defaults.headers.common[\"Authorization\"];\n        resolve();\n      });\n    }\n  },\n  getters: {\n    isLoggedIn: state => !!state.token,\n    isAdmin: state => state.esAdmin,\n    authStatus: state => state.status,\n    token: state => state.token\n  }\n});\n"]}]}